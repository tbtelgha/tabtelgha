bot=dofile('utils.lua')sudos=dofile('sudo.lua')URL=require"socket.url"serpent=require("serpent")http=require"socket.http"https=require"ssl.https"redis=require('redis')db=redis.connect('127.0.0.1',6379)function vardump(a)print(serpent.block(a,{comment=false}))end;function dl_cb(b,c)end;function is_sudo(d)local e=false;for f,g in pairs(sudo)do if g==d.sender_user_id_ or db:sismember('modsID',d.sender_user_id_)then e=true end end;return e end;function kl(h)if h~=0 then local i=os.time()repeat until os.time()>i+h end end;function run(d,c)function aj_check()if db:get('aj1ID')==nil then db:set('aj1ID','off')return false elseif db:get('aj1ID')=="on"then return true elseif db:get('aj1ID')=="off"then return false end end;function rejoin()function joinlinkss(j,k,l)if k.ID=='Error'then if k.code_~=429 then db:srem('linksSID',j.lnk)db:sadd('elinksSID',j.lnk)end else db:srem('linksSID',j.lnk)db:sadd('elinksSID',j.lnk)end end;if(tonumber(db:get("tedgpSID"))or 999)>=tonumber(db:scard("bcSID"))then local m=db:smembers('linksSID')for n,f in pairs(m)do tdcli_function({ID="ImportChatInviteLink",invite_link_=f},joinlinkss,{lnk=f})end end end;if tostring(d.chat_id_):match('-')then if tostring(db:get('seenSID'))=="gp"or tostring(db:get('seenSID'))=="all"then bot.viewMessages(d.chat_id_,{[0]=d.id_})end;if not db:sismember('bcSID',d.chat_id_)then db:sadd('bcSID',d.chat_id_)db:sadd('glbc',d.chat_id_)for f,g in pairs(db:smembers("addsSID"))do tdcli_function({ID="AddChatMember",chat_id_=d.chat_id_,user_id_=g,forward_limit_=50},dl_cb,nil)end elseif not db:sismember('bcSID',d.chat_id_)and db:sismember("glbc",d.chat_id_)then bot.changeChatMemberStatus(d.chat_id_,bot_id,"Left")end elseif not tostring(d.chat_id_):match('-')then if db:get('automSID')=='on'then if d.content_.text_:match("سلام")then bot.sendMessage(d.chat_id_,d.id_,1,'سلام','md')elseif d.content_.text_:match("خوبی")then bot.sendMessage(d.chat_id_,d.id_,1,'مرسی تو خوبی؟','md')end end;if tostring(db:get('seenSID'))=="pv"or tostring(db:get('seenSID'))=="all"then bot.viewMessages(d.chat_id_,{[0]=d.id_})end;if not db:sismember('usersSID',d.chat_id_)then function lkj(j,k,l)if k.ID~='Error'then db:sadd('usersSID',d.chat_id_)end end;tdcli_function({ID="GetUser",user_id_=d.chat_id_},lkj,nil)end end;local o=nil;if d.content_.text_ and d.content_.entities_ and d.content_.entities_[0]and d.content_.entities_[0].ID=='MessageEntityUrl'then o=d.content_.text_ or d.content_.text_;function check_link(p,q,r)function joinlinks(j,k,l)if k.ID=='Error'then if k.code_~=429 then db:srem('linksSID',j.lnk)db:sadd('elinksSID',j.lnk)end else db:srem('linksSID',j.lnk)db:sadd('elinksSID',j.lnk)db:sadd('elinksg',j.lnk)end end;if not db:sismember('elinksg',p.link)and tostring(q.is_supergroup_channel_)=='true'and q.member_count_>(tonumber(db:get('tahgpSID'))or 50)and q.member_count_<tonumber(db:get('tahgp2SID')or 5000)and not db:sismember('linksSID',p.link)and not db:sismember('elinksSID',p.link)then db:sadd('linksSID',p.link)if aj_check()then tdcli_function({ID="ImportChatInviteLink",invite_link_=p.link},joinlinks,{lnk=p.link})end end end;if db:get('joinlSID')=='on'or db:get('joinlSID')==nil then local s={}if o and o:match("https://telegram.me/joinchat/%S+")then s={o:match("(https://t.me/joinchat/%S+)")or o:match("(https://telegram.me/joinchat/%S+)")}tdcli_function({ID="CheckChatInviteLink",invite_link_=s[1]},check_link,{link=s[1]})elseif o and o:match("https://t.me/joinchat/%S+")then s={string.gsub(o:match("(https://t.me/joinchat/%S+)"),"t.me","telegram.me")}tdcli_function({ID="CheckChatInviteLink",invite_link_=s[1]},check_link,{link=s[1]})end end;if db:get('timerSID')==nil then local t=math.random(684,1248)db:setex('timerSID',tonumber(t),true)rejoin()end;local o=nil elseif is_sudo(d)then o=d.content_.text_ end;if o then if is_sudo(d)then if o=='help'then local f=" راهنمای دستورات تبچی\n 🗓 اطلاعات\n 🔹 panel\n ➖➖➖➖➖➖➖➖➖➖➖\n ↖️دریافت لیست تمامی لینک های ذخیره شده \n 🔹exlinks ➖➖➖➖➖➖➖➖➖➖➖\n 🗒تنظیم محدودیت ممبر های گروه\n🔹gpmem x/y\nمثال:\ngpmem 1/10000\nکمترین تعداد ممبر های گروه 1 و بیشترین\nتعداد 10 هزار نفر \n➖➖➖➖➖➖➖➖➖➖➖\n 🕐کنترل وضعیت افزایش گروه  \n🔹join [on | off] \n ➖➖➖➖➖➖➖➖➖➖➖\n 🕰تنظیم مدت زمان تاخیر بین ارسال ها \n 🔹setsec [number] \n ➖➖➖➖➖➖➖➖➖➖➖\n📥پاسخگوی خودکار\nخاموش کردن:\n\n🔹autom off\nروشن کردن:\n🔹autom on \n➖➖➖➖➖➖➖➖➖➖➖\n ➕اضافه کردن مخاطب \n 🔹addc [reply] \n شماره شیر شده را ریپلای کرده و دستور را بزنید \n➖➖➖➖➖➖➖➖➖➖➖\n 🗒نمایش اطلاعات ربات \n 🔹botinfo \n➖➖➖➖➖➖➖➖➖➖➖\n🌪اضافه کردن شخص به تمامی گروها\n🔹addall [reply | username]\nپیام شخص را ریپلای کرده و دستور را به تنهایی بزنید یا\nایدی شخص را جلو دستور قرار دهید\nمثال:\naddall @c0912 \n➖➖➖➖➖➖➖➖➖➖➖\n 🌁تغییر عکس پروفایل \n 🔹setphoto link \n به جای لینک لینک عکس موردنظر را بزارید \n➖➖➖➖➖➖➖➖➖➖➖\n 👁‍🗨تنظیمات سین\n🔹seen gp\nتنها پیام های گروه ها سین خواهند خورد\n🔹seen pv\nفقط پیام های توی پیوی سین خواهند خورد\n🔹seen all\nتمامی پیام ها سین خواهند خورد\n🔹seen off\nهیچ پیامی سین نخواهد خورد\n ➖➖➖➖➖➖➖➖➖➖➖\n 🔃 حذف تمامی گروه ها\n 🔹 remgp\n ➖➖➖➖➖➖➖➖➖➖➖\n ☢️ چک کردن گروه های در دسترس\n 🔹gpcheck\n ➖➖➖➖➖➖➖➖➖➖➖\n 📣 ارسال پیام به همه ی گروه ها(با ریپلی)\n 🔹bc\n ➖➖➖➖➖➖➖➖➖➖➖\n 🔊 ارسال پیام به تمامی گروه ها به صورت رگباری به تعداد عدد\n انتخابی\n 🔹nbc [nubmer]\n ➖➖➖➖➖➖➖➖➖➖➖\n 🔂 عضویت در لینک های ذخیره شده\n 🔹rejoin\n ➖➖➖➖➖➖➖➖➖➖➖\n ⚠️ حذف تمامی لینک های ذخیره شده(استفاده نشده)\n 🔹remlinks\n ➖➖➖➖➖➖➖➖➖➖➖\n ♦️حذف لینک های استفاده شده\n 🔹remelinks\n 📛توجه داشتید باشید در این دستور یک e اضافی هست - با دستور حذف لینک های ذخیره شده اشتباه نکنید\n ➖➖➖➖➖➖➖➖➖➖➖\n 📉 نمایش اطلاعات سرور\n 🔹serverinfo\n ➖➖➖➖➖➖➖➖➖➖➖\n ↩️روشن و خاموش کردن جوین اتوماتیک\n 🔹aj\n 📛راهنما:\n https://t.me/Globaltab/3\n ➖➖➖➖➖➖➖➖➖➖➖\n 🔷فروارد اتوماتیک\n https://t.me/Globaltab/4 \n ➖➖➖➖➖➖➖➖➖➖➖\n 📣ارسال پست به تمامی کاربران(پیوی ها)\n 🔹bc u\n ◽️ریپلای شود\n ➖➖➖➖➖➖➖➖➖➖➖\n 🔂چک کردن پیوی ها\n 🔹pvcheck\n ➖➖➖➖➖➖➖➖➖➖➖\n 🔀ارسال پیام بدون فروارد به همه کاربران\n 🔹bc echo u\n ➖➖➖➖➖➖➖➖➖➖➖\n 👤حذف تمامی کاربران\n 🔹rem users\n ➖➖➖➖➖➖➖➖➖➖➖\n ➕اضافه کردن ادمین(سودو)\n \n 🔹promote [reply | username | userid]\n ➖➖➖➖➖➖➖➖➖➖➖\n ➖حذف کردن از لیست مدیران(سودو)\n \n 🔹demote [reply | username | userid]\n ➖➖➖➖➖➖➖➖➖➖➖\n 📈اضافه کردن کاربران به گروه(اد ممبر)\n \n 🔹addmembers\n ➖➖➖➖➖➖➖➖➖➖➖\n 📰تغییر نام اکانت\n 🔹setname [name]\n مثال:\n setname علی\n ➖➖➖➖➖➖➖➖➖➖➖\n 🔈ارسال پیام بدون فروارد(رپلای)\n 🔹bc echo\n 📛نکته: در پیام موردنظرتون میتوانید از تگ هایhtml استفاده کنید تا پیام ارسالی زیباتر شود مثال:\n <b>Test</b>\n سپس پیام را ریپلای کرده و دستور\n را وارد کنید\n 🔸🔸🔸🔸🔸🔸🔸🔹🔹🔹🔹🔹🔹\n ➡️ دستورات ربات : "..string.char(64,80,49,48,48,48).."\n ➡️ Production Date: "..string.char(57,55).."\n"bot.sendMessage(d.chat_id_,d.id_,1,f,'md')elseif o=='bc'and tonumber(d.reply_to_message_id_)>0 then function cb(j,k,l)local m=db:smembers('bcSID')local u=db:scard('bcSID')local v=db:get('secSID')or 0;bot.sendMessage(d.chat_id_,d.id_,1,'ربات با تاخیر '..v..' شروع به ارسال پیام شما کرد زمان تخمینی اتمام کار ربات '..u*v..'ثانیه است لطفا صبور باشید','md')for n,f in pairs(m)do kl(v)bot.forwardMessages(f,d.chat_id_,{[0]=k.id_},1)end end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),cb)elseif o=='bc u'and tonumber(d.reply_to_message_id_)>0 then function cb(j,k,l)local m=db:smembers('usersSID')local v=db:get('secSID')or 0;local u=db:scard('usersSID')bot.sendMessage(d.chat_id_,d.id_,1,'ربات با تاخیر '..v..' شروع به ارسال پیام شما کرد زمان تخمینی اتمام کار ربات '..u*v..'ثانیه است لطفا صبور باشید','md')for n,f in pairs(m)do kl(v)bot.forwardMessages(f,d.chat_id_,{[0]=k.id_},1)end end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),cb)elseif o:match('^seen (.*)')then local w=o:match('seen (.*)')local x=nil;if w=='pv'then db:set('seenSID','pv')x='فقط پیام های پیوی سین خواهد خورد'elseif w=='gp'then db:set('seenSID','gp')x='ققط پیام های گروه ها سین خواهد خورد'elseif w=='off'then db:set('seenSID','off')x='هیچ پیامی سین زده نخواهد شد'elseif w=='all'then db:set('seenSID','all')x='تمامی پیام ها سین خواهند خورد'end;bot.sendMessage(d.chat_id_,d.id_,1,x..'✔️','md')elseif o=='panel'or o:match("panel(%d+)$")then local y=tonumber(o:match('panel(.*)'))local m=db:scard('bcSID')local z=db:scard('linksSID')local A=db:scard('elinksSID')local B=db:scard('usersSID')local C=0;local D=' 'local E=0;local F,G,H,I;if aj_check()then C='✅'else C='❌'end;if db:get('autobcsSID')=='on'then D='✅'else D='❌'end;if db:get('automSID')=='on'then G='✅'else G='❌'end;if db:get('joinlSID')=='off'then F='❌'else F='✅'end;if db:scard('elinksg')then elinksgg=db:scard('elinksg')else elinksgg=0 end;if db:scard('glbc')then glbc=db:scard('glbc')else glbc=0 end;local J=require"json"local K=io.popen("curl https://api.bot-dev.org/time -L"):read("*all")local L=J:decode(K).FAtime;local M=J:decode(K).FAdate;local N='Ir Time: '..L..'\nIr Data: _'..M;if db:get('tahgpSID')==nil or db:get('tahgp2SID')==nil then db:set('tahgpSID',50)db:set('tahgp2SID',5000)I="50/5000"else I=db:get('tahgpSID').."/"..db:get('tahgp2SID')end;if db:get('seenSID')=='off'or db:get('seenSID')==nil then H='❌'elseif db:get('seenSID')=='pv'then H='(پیوی ها)✅'elseif db:get('seenSID')=='gp'then H='(گروه ها)✅'elseif db:get('seenSID')=='all'then H='(همه پیام ها)✅'end;if db:ttl("timeraSID")==-2 then E=0 else E=db:ttl("timeraSID")end;if y==2 then function fuck(j,k,l)if k.ID=='Error'then bot.searchPublicChat("Globaltab_robot")bot.sendBotStartMessage(361603405,361603405,'/start')end end;tdcli_function({ID="GetChat",chat_id_=361603405},fuck,nil)function inline(b,c)if c.results_ and c.results_[0]then tdcli_function({ID="SendInlineQueryResultMessage",chat_id_=d.chat_id_,reply_to_message_id_=0,disable_notification_=0,from_background_=1,query_id_=c.inline_query_id_,result_id_=c.results_[0].id_},dl_cb,nil)end end;local O='/sg '..m..' /lnk '..z..' /elnk '..A..' /end '..C..' /aj '..D..' /abc '..E..' /eabc '..B..' /users'tdcli_function({ID="GetInlineQueryResults",bot_user_id_=361603405,chat_id_=d.chat_id_,user_location_={ID="Location",latitude_=0,longitude_=0},query_=O,offset_=0},inline,nil)else local P=math.random(1,3)if P==1 then local Q='\nاماری از تبچی\n\n 👥سوپر گروه ها: '..m..'\n 📈تعداد لینک های موجود:  '..z..'\n 🔚لینک های استفاده شده: '..A..'\n 👤تعداد کاربرها(پیوی): '..B..'\n 🔄جوین اتوماتیک: '..C..'\n📗لینک های استفاده شده همگانی:'..elinksgg..'\n📖تعداد گروه های همه ربات ها :'..glbc..'\n📔محدودیت اعضا:'..I..'\n👁‍🗨سین زدن پیام ها : '..H..'\n📝پاسخگوی خودکار : '..G..'\n 🚹جوین شدن در لینکها:'..F..'\n\n Gp-ID: '..d.chat_id_..'\nYour-User-Id: '..d.sender_user_id_..'\n  ♥️ '..string.char(64,80,49,48,48,48)bot.sendMessage(d.chat_id_,d.id_,1,Q,'md')elseif P==2 then local N='ساعت: '..L..'\nتاریخ: _'..M..'\n'local Q='\n Your Globaltab -> \n\n SuperGroups '..m..'\n Links  '..z..'\n Link used '..A..'\n Users in PV '..B..'\n Automatic Join '..C..'\nMember limitations '..I..'\n Msg Seen '..H..'\n Supergroups(global)'..glbc..'\nUsed Links(global) :'..elinksgg..'\n Auto Answer : '..G..'\n Join In Links '..F..'\n\n Gp-ID: '..d.chat_id_..'\nYour-User-Id: '..d.sender_user_id_..'\n'..N..'\n  ♥️ '..string.char(64,80,49,48,48,48)bot.sendMessage(d.chat_id_,d.id_,1,Q,'md')elseif P==3 then local N='ساعت ایران: '..L..'\nتاریخ ایران: _'..M..'\n'local Q='\n Gp-ID: '..d.chat_id_..'\nYour-User-Id: '..d.sender_user_id_..'\n'..N..' تبچی شما-> \n\n SuperGroups '..m..'\n Links  '..z..'\n Link used '..A..'\n Users in PV '..B..'\n Automatic Join '..C..'\nMember limitations '..I..'\n Msg Seen '..H..'\n Auto Answer : '..G..'\n Join In Links '..F..'\n\n '..string.char(64,80,49,48,48,48)bot.sendMessage(d.chat_id_,d.id_,1,Q,'md')end end elseif o:match('^nbc (%d+)$')and tonumber(d.reply_to_message_id_)>0 then local R=tonumber(o:match('nbc (.*)'))function cb(j,k,l)local m=db:smembers('bcSID')for n,f in pairs(m)do for S=1,R,1 do bot.forwardMessages(f,d.chat_id_,{[0]=k.id_},1)end end end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),cb)elseif o=='rejoin'then rejoin()bot.sendMessage(d.chat_id_,d.id_,1,'وارد لینک های ذخیره شده شدم☑️',1,'html')elseif o=='aj'then if db:get('aj1SID')=='off'then db:set('aj1SID','on')bot.sendMessage(d.chat_id_,d.id_,1,'جوین اتوماتیک روشن شد✔️','md')elseif db:get('aj1SID')=='on'then db:set('aj1SID','off')bot.sendMessage(d.chat_id_,d.id_,1,'جوین اتوماتیک خاموش شد⛔️','md')elseif db:get('aj1SID')==nil then db:set('aj1SID','on')bot.sendMessage(d.chat_id_,d.id_,1,'جوین اتوماتیک روشن شد✔️','md')end elseif o=='botinfo'then function lkj(l,T)local U=''if T.last_name_ then U=T.last_name_ else U='(خالی)'end;ip=io.popen("curl https://api.ipify.org"):read('*all')bot.sendMessage(d.chat_id_,d.id_,1,'🗒نام: '..T.first_name_..'\n 📄نام خانوادگی : '..U..'\n 📋یوزر ایدی : '..T.id_..'\n 📱شماره:\n <code>+'..T.phone_number_..'</code> \n 🕰زمان تاخیر بین ارسالها: '..(db:get('secSID')or 1)..'ثانیه \n🌐ایپی سرور:\n '..ip..'\n\n 📮version: 8\n☘️ @E6000 🌿',1,'html')end;tdcli_function({ID="GetMe"},lkj,nil)elseif o=='serverinfo'then local o=io.popen("sh ./servinfo.sh"):read('*all')bot.sendMessage(d.chat_id_,d.id_,1,o,1,'html')elseif o=='bc echo'and tonumber(d.reply_to_message_id_)>0 then function cb(j,k,l)local m=db:smembers('bcSID')local u=db:scard('bcSID')local v=db:get('secSID')or 0;bot.sendMessage(d.chat_id_,d.id_,1,'ربات با تاخیر '..v..' شروع به ارسال پیام شما کرد زمان تخمینی اتمام کار ربات '..u*v..'ثانیه است لطفا صبور باشید','md')for n,f in pairs(m)do kl(v)bot.sendMessage(f,1,1,k.content_.text_,1,'html')end end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),cb)elseif o=='bc echo u'and tonumber(d.reply_to_message_id_)>0 then function cb(j,k,l)local m=db:smembers('usersSID')local u=db:scard('usersSID')local v=db:get('secSID')or 0;bot.sendMessage(d.chat_id_,d.id_,1,'ربات با تاخیر '..v..' شروع به ارسال پیام شما کرد زمان تخمینی اتمام کار ربات '..u*v..'ثانیه است لطفا صبور باشید','md')for n,f in pairs(m)do kl(v)bot.sendMessage(f,1,1,k.content_.text_,1,'html')end end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),cb)elseif o=='addc'and tonumber(d.reply_to_message_id_)>0 then function cb(V,k,n)bot.importContacts(k.content_.contact_.phone_number_,k.content_.contact_.first_name_,k.content_.contact_.last_name_,k.content_.contact_.user_id_)bot.sendMessage(k.chat_id_,k.id_,1,'کاربر مورد نظر با موفقیت اد شد','md')end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),cb)elseif o=='remlinks'then db:del('linksSID')bot.sendMessage(d.chat_id_,d.id_,1,'لینک های ذخیره شده با موفقیت پاک شدند✔️ \n🖤 @E6000 🖤',1,'html')elseif o=='remgp'then db:del('bcSID')bot.sendMessage(d.chat_id_,d.id_,1,'همه گروه ها از دیتابیس حذف شدند✅ \n💠 @E6000','md')elseif o=='rem users'then db:del('usersSID')bot.sendMessage(d.chat_id_,d.id_,1,'🔸یوزر ها از دیتابیس پاک شدند!','md')elseif o=='remelinks'then db:del('elinksSID')bot.sendMessage(d.chat_id_,d.id_,1,'🔸لینک های استفاده شده با موفقیت حذف شدند❗️\n🌀@E6000',1,'html')elseif o=='gpcheck'then local W=db:scard('bcSID')function checkm(b,c,T)if c.ID=='Error'then db:srem('bcSID',b.chatid)end end;function sendresult()bot.sendMessage(d.chat_id_,d.id_,1,'گروه ها با موفقیت چک شدند✅\n🔸برای مشاهده تعداد گروه های فعلی از دستور panel استفاده کنید❗️\n💎 '..string.char(64,80,49,48,48,48),1,'html')end;local m=db:smembers('bcSID')for n,f in pairs(m)do tdcli_function({ID="GetChatHistory",chat_id_=f,from_message_id_=0,offset_=0,limit_=1},checkm,{chatid=f})if W==n then sendresult()end end elseif o:match("^adds @(.*)")then local X=o:match('^adds @(.*)')function demreply(p,q,r)if q.id_ then o='کاربر (<code>'..q.id_..'</code>) به لیست اضافه شد!'db:sadd("addsSID",q.id_)else o='<i>کاربر یافت نشد!</i>'end;bot.sendMessage(d.chat_id_,d.id_,1,o,'html')end;local function Y(X,cb)tdcli_function({ID="SearchPublicChat",username_=X},cb,nil)end;Y(X,demreply)elseif o=="rem adds"then db:del("addsBOT-SID")bot.sendMessage(d.chat_id_,d.id_,1,"با موفقیت پاک شدند!",'html')elseif o:match('^autom (.*)')then local Z=o:match('autom (.*)')if Z=='off'then db:set('automSID','off')bot.sendMessage(d.chat_id_,d.id_,1,'پاسخگوی خودکار خاموش شد','md')elseif Z=='on'then db:set('automSID','on')bot.sendMessage(d.chat_id_,d.id_,1,'پاسخگوی خودکار روشن شد','md')end elseif o:match("^start @(.*)")then local X=o:match('^start @(.*)')function promreply(p,q,r)if q.id_ then tdcli_function({ID="SendBotStartMessage",bot_user_id_=q.id_,chat_id_=q.id_,parameter_='start'},dl_cb,nil)o='<code>'..q.id_..'</code><b>دراکانت استارت خورد!</b>'else o='<i>کاربر یافت نشد</i>'end;bot.sendMessage(d.chat_id_,d.id_,1,o,'html')end;tdcli_function({ID="SearchPublicChat",username_=X},promreply,nil)elseif o:match('^join (.*)')then local Z=o:match('join (.*)')if Z=='off'then db:set('joinlSID','off')bot.sendMessage(d.chat_id_,d.id_,1,'ربات دیگر در هیچ گروهی عضو نمیشود','md')elseif Z=='on'then db:set('joinlSID','on')bot.sendMessage(d.chat_id_,d.id_,1,'ربات شروع به جوین در گروه ها کرد','md')end elseif o:match('^setn (%d+)$')then local R=tonumber(o:match('setn (.*)'))db:set('tedgpSID',R)bot.sendMessage(d.chat_id_,1,1,'ربات در تعداد '..R..' گروه عضو میشود',1,'html')elseif o:match("^setsec (%d+)")then local _=tonumber(o:match('setsec (.*)'))db:set('secSID',_)bot.sendMessage(d.chat_id_,d.id_,1,'تنظیمات به '.._..'ثانیه تغییر کرد!','md')elseif o=='pvcheck'then local B=db:smembers('usersSID')function lkj(j,k,l)if k.ID=='Error'then db:srem("userSID",j.usr)end end;for n,f in pairs(B)do tdcli_function({ID="GetUser",user_id_=f},lkj,{usr=f})end;bot.sendMessage(d.chat_id_,d.id_,1,'⭕️کاربران با موفقیت چک شدند!',1,'html')elseif o=='exlinks'then local B=db:smembers('usersSID')function lkj(j,k,l)if k.ID=='Error'then db:srem("userSID",j.usr)end end;local a0=''for n,f in pairs(db:smembers('elinksSID'))do a0=a0 ..f..'\n'end;for n,f in pairs(db:smembers('linkSID'))do a0=a0 ..f..'\n'end;bot.sendMessage(d.chat_id_,d.id_,1,a0,'md')elseif o:match('^gpmem (%d+)/(%d+)$')then local a1=tonumber(o:match('gpmem (.*)/'))local a2=tonumber(o:match('/(.*)'))db:set('tahgpSID',a1)db:set('tahgp2SID',a2)bot.sendMessage(d.chat_id_,1,1,'کمترین عضو '..a1 ..' \n بیشترین عضو '..a2,1,'html')elseif o:match('^setname (.*)$')then local a3=o:match('setname (.*)')bot.changeName(a3,'')bot.sendMessage(d.chat_id_,d.id_,1,'اسم اکانت به '..a3 ..' تغییر یافت✔️',1,'md')elseif o=='promote'and tonumber(d.reply_to_message_id_)~=0 then function prom_reply(p,q,r)db:sadd('modsSID',q.sender_user_id_)local g=q.sender_user_id_;bot.sendMessage(d.chat_id_,d.id_,1,'<code>'..g..'</code><b> مدیر ربات شد!!</b>',1,'html')end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),prom_reply)elseif o:match('^promote @(.*)')then local X=o:match('^promote @(.*)')function promreply(p,q,r)if q.id_ then db:sadd('modsSID',q.id_)o='<code>'..q.id_..'</code><b> مدیر ربات شد!!</b>'else o='<i>کاربر یافت نشد</i>'end;bot.sendMessage(d.chat_id_,d.id_,1,o,1,'html')end;bot.resolve_username(X,promreply)elseif o:match('^addall')then if o:match('^addall @(.*)')then local X=o:match('^addall @(.*)')function promreply(p,q,r)if q.id_ then local m=db:smembers('bcSID')for n,f in pairs(m)do tdcli_function({ID="AddChatMember",chat_id_=f,user_id_=q.id_,forward_limit_=50},dl_cb,nil)end;db:sadd('modsSID',q.id_)o='<code>'..q.id_..'</code><b>به تمامی گروه های ربات اد شد!!</b>'else o='<i>کاربر یافت نشد</i>'end;bot.sendMessage(d.chat_id_,d.id_,1,o,1,'html')end;bot.resolve_username(X,promreply)elseif o=='addall'and tonumber(d.reply_to_message_id_)~=0 then function prom_reply(p,q,r)local m=db:smembers('bcSID')for n,f in pairs(m)do tdcli_function({ID="AddChatMember",chat_id_=f,user_id_=q.sender_user_id_,forward_limit_=50},dl_cb,nil)end;bot.sendMessage(d.chat_id_,d.id_,1,'<code>'..q.sender_user_id_..'</code><b> اکانت موردنظر به تمامی گروه های ربات اد شد!!</b>',1,'html')end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),prom_reply)elseif o:match('^addall (%d+)')then local a4=o:match('addall (.*)')local m=db:smembers('bcSID')for n,f in pairs(m)do tdcli_function({ID="AddChatMember",chat_id_=f,user_id_=a4,forward_limit_=50},dl_cb,nil)end;bot.sendMessage(d.chat_id_,d.id_,1,'کاربر مورد نظر به تمامی گروه هام اد شد!',1,'html')end elseif o:match('^promote (%d+)')then local g=o:match('promote (%d+)')db:sadd('modsSID',g)bot.sendMessage(d.chat_id_,d.id_,1,'کاربر(<code>'..g..'</code>)<b> مدیر این ربات شد!!</b>',1,'html')elseif o=='demote'and tonumber(d.reply_to_message_id_)~=0 then function prom_reply(p,q,r)db:srem('modsSID',q.sender_user_id_)bot.sendMessage(d.chat_id_,d.id_,1,'<code>'..q.sender_user_id_..'</code><b> از لیست مدیریت حذف شد!!</b>',1,'html')end;bot.getMessage(d.chat_id_,tonumber(d.reply_to_message_id_),prom_reply)elseif o:match('^demote @(.*)')then local X=o:match('^demote @(.*)')function demreply(p,q,r)if q.id_ then db:srem('modsSID',q.id_)o='کاربر (<code>'..q.id_..'</code>) از لیست مدیران حذف شد!'else o='<i>کاربر یافت نشد!</i>'end;bot.sendMessage(d.chat_id_,d.id_,1,o,1,'html')end;bot.resolve_username(X,demreply)elseif o:match('^demote (%d+)')then local g=o:match('demote (%d+)')db:srem('modsSID',g)bot.sendMessage(d.chat_id_,d.id_,1,'کاربر (<code>'..g..'</code>)<b> از لیست مدیریت حذف شد!!</b>',1,'html')elseif o:match("^setphoto (.*)$")then local a5={string.match(o,"^(setphoto) (.*)$")}local a6=os.clock()local http=require("socket.http")local a7,a8=http.request(a5[2])if not a7 then error(a8)end;local a9=assert(io.open(a6 ..'photo.jpg','wb'))a9:write(a7)a9:close()bot.setProfilePhoto(a6 ..'photo.jpg')bot.sendMessage(d.chat_id_,d.id_,1,'عکس جدید تنظیم شد✔️','md')elseif o=='admins'then local j=db:smembers('modsSID')local aa='لیست مدیران ربات : \n'for S=1,#j do aa=aa..S..'-  '..j[S]..'\n'end;aa=aa..'\n @E6000'bot.sendMessage(d.chat_id_,d.id_,1,aa,'md')elseif o=='addss'then local j=db:smembers('addsSID')local aa='اد لیست : \n'for S=1,#j do aa=aa..S..'-  '..j[S]..'\n'end;aa=aa..'\n @E6000'bot.sendMessage(d.chat_id_,d.id_,1,aa,'md')elseif o=='addmembers'then local m=db:smembers('usersSID')for n,f in pairs(m)do tdcli_function({ID="AddChatMember",chat_id_=d.chat_id_,user_id_=f,forward_limit_=50},dl_cb,nil)end end end end end;function tdcli_update_callback(c)if c.ID=="UpdateNewMessage"then run(c.message_,c)elseif c.ID=="UpdateOption"and c.name_=="my_id"then tdcli_function({ID="GetChats",offset_order_="9223372036854775807",offset_chat_id_=0,limit_=20},dl_cb,nil)end end